<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lintoria Hub V4.02</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary: #2563eb; --gold: #fbbf24; --success: #10b981; --danger: #ef4444;
            --bg-primary: #050817; --bg-secondary: #0f172a; --bg-card: rgba(15, 23, 42, 0.8);
            --text-primary: #f8fafc; --text-secondary: #cbd5e1; --text-muted: #64748b;
            --border: rgba(148, 163, 184, 0.1);
            --rarity-common: #ffffff; --rarity-uncommon: #22c55e; --rarity-rare: #3b82f6;
            --rarity-epic: #a855f7; --rarity-legendary: #fbbf24; --rarity-mythic: #ec4899; --rarity-divine: #06b6d4;
        }

        body { font-family: 'Inter', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }

        .app-container { position: relative; z-index: 10; min-height: 100vh; padding: 1.5rem; max-width: 1400px; margin: 0 auto; }

        .glass-card {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.05) 0%, rgba(251, 191, 36, 0.05) 100%);
            backdrop-filter: blur(20px); border: 1px solid var(--border); border-radius: 20px; padding: 1.5rem;
            margin-bottom: 1.5rem; transition: all 0.3s ease;
        }
        .glass-card:hover { transform: translateY(-2px); box-shadow: 0 20px 40px rgba(37, 99, 235, 0.2); }

        .logo-container { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
        .logo-icon { width: 50px; height: 50px; background: linear-gradient(135deg, #2563eb, #fbbf24); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .logo-text { font-size: 2rem; font-weight: 800; background: linear-gradient(135deg, #2563eb, #fbbf24); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .logo-badge { padding: 0.3rem 0.8rem; background: linear-gradient(135deg, #f59e0b, #fbbf24); color: #050817; font-size: 0.7rem; font-weight: 800; border-radius: 20px; margin-left: 0.5rem; }

        .disclaimer-banner { background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(251, 191, 36, 0.15)); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; font-size: 0.8rem; }
        .disclaimer-banner strong { color: var(--danger); }

        .tab-container { display: flex; gap: 0.5rem; padding: 0.5rem; background: rgba(37, 99, 235, 0.1); border: 1px solid var(--border); border-radius: 16px; margin-bottom: 1.5rem; overflow-x: auto; flex-wrap: wrap; }
        .tab-section { display: flex; gap: 0.3rem; padding: 0.3rem; background: rgba(255, 255, 255, 0.03); border-radius: 12px; }
        .tab-btn { padding: 0.6rem 1rem; background: rgba(37, 99, 235, 0.1); color: var(--text-secondary); border: none; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 0.8rem; transition: all 0.3s ease; white-space: nowrap; }
        .tab-btn:hover { color: var(--text-primary); background: rgba(251, 191, 36, 0.2); }
        .tab-btn.active { background: linear-gradient(135deg, #2563eb, #fbbf24); color: white; }

        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; margin-bottom: 0.4rem; font-weight: 700; font-size: 0.75rem; color: var(--gold); text-transform: uppercase; letter-spacing: 1px; }
        .form-input, select { width: 100%; padding: 0.8rem 1rem; background: rgba(15, 23, 42, 0.6); border: 2px solid var(--border); border-radius: 10px; color: var(--text-primary); font-size: 0.9rem; transition: all 0.3s ease; }
        .form-input:focus, select:focus { outline: none; border-color: var(--gold); }

        .btn { padding: 0.8rem 1.5rem; border: none; border-radius: 10px; font-weight: 700; font-size: 0.8rem; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; }
        .btn:hover { transform: translateY(-2px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-success { background: linear-gradient(135deg, #f59e0b, #fbbf24); color: #050817; }
        .btn-danger { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .btn-sm { padding: 0.4rem 0.8rem; font-size: 0.7rem; }

        .balance-card { background: linear-gradient(135deg, #1e40af, #fbbf24); padding: 2rem; border-radius: 20px; text-align: center; margin-bottom: 1.5rem; }
        .balance-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 2px; color: rgba(255,255,255,0.9); font-weight: 700; }
        .balance-amount { font-size: 2.5rem; font-weight: 900; color: white; font-family: 'Space Grotesk', sans-serif; }

        .credit-score-card { background: linear-gradient(135deg, rgba(37, 99, 235, 0.2), rgba(251, 191, 36, 0.2)); border: 2px solid var(--gold); border-radius: 16px; padding: 1.5rem; text-align: center; margin-bottom: 1rem; }
        .credit-score-number { font-size: 3rem; font-weight: 900; font-family: 'Space Grotesk', sans-serif; }
        .credit-tier { font-size: 1rem; font-weight: 700; margin-top: 0.5rem; }
        .credit-tier.very-poor { color: #ef4444; }
        .credit-tier.poor { color: #f97316; }
        .credit-tier.fair { color: #eab308; }
        .credit-tier.good { color: #22c55e; }
        .credit-tier.very-good { color: #3b82f6; }
        .credit-tier.excellent { color: #a855f7; }

        .loan-card { background: rgba(37, 99, 235, 0.1); border: 1px solid var(--border); border-radius: 14px; padding: 1.25rem; margin-bottom: 1rem; transition: all 0.3s ease; }
        .loan-card:hover { border-color: var(--gold); }
        .loan-card.active { border-left: 4px solid var(--success); }
        .loan-card.defaulted { border-left: 4px solid var(--danger); opacity: 0.7; }
        .loan-card.paid { border-left: 4px solid var(--gold); opacity: 0.8; }

        .loan-type-card { background: rgba(37, 99, 235, 0.1); border: 2px solid var(--border); border-radius: 14px; padding: 1.25rem; cursor: pointer; transition: all 0.3s ease; }
        .loan-type-card:hover { border-color: var(--gold); transform: translateY(-3px); }
        .loan-type-card.disabled { opacity: 0.5; cursor: not-allowed; }

        .progress-bar { height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; margin: 0.5rem 0; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--success), var(--gold)); border-radius: 4px; transition: width 0.5s ease; }

        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.75rem; }
        .stat-item { background: rgba(37, 99, 235, 0.1); padding: 1rem; border-radius: 10px; text-align: center; }
        .stat-label { font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        .stat-value { font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-top: 0.25rem; }
        .stat-value.positive { color: var(--success); }
        .stat-value.negative { color: var(--danger); }

        .reset-card { background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(251, 191, 36, 0.1)); border: 2px solid rgba(239, 68, 68, 0.3); border-radius: 16px; padding: 1.5rem; text-align: center; }

        .transaction-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: rgba(37, 99, 235, 0.05); border: 1px solid var(--border); border-radius: 12px; margin-bottom: 0.75rem; }

        .service-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .service-card { background: rgba(37, 99, 235, 0.08); border: 1px solid var(--border); border-radius: 14px; padding: 1.25rem; transition: all 0.3s ease; }
        .service-card:hover { transform: translateY(-3px); border-color: var(--gold); }

        .section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border); }
        .section-header h2 { font-size: 1.1rem; font-weight: 700; color: var(--gold); }
        .badge { padding: 0.2rem 0.6rem; background: rgba(251, 191, 36, 0.2); border-radius: 20px; font-size: 0.7rem; color: var(--gold); }

        .casino-game { background: rgba(37, 99, 235, 0.1); border: 1px solid var(--border); border-radius: 16px; padding: 1.25rem; }

        .chat-container { height: 300px; overflow-y: auto; background: rgba(15, 23, 42, 0.6); border-radius: 12px; padding: 0.75rem; margin-bottom: 0.75rem; }
        .chat-message { margin-bottom: 0.5rem; padding: 0.5rem 0.75rem; background: rgba(37, 99, 235, 0.1); border-radius: 8px; }
        .chat-username { font-weight: 700; color: var(--gold); font-size: 0.8rem; }
        .chat-text { color: var(--text-primary); font-size: 0.85rem; }
        .chat-time { font-size: 0.65rem; color: var(--text-muted); }

        .pack-card { background: rgba(37, 99, 235, 0.1); border: 2px solid var(--border); border-radius: 16px; padding: 1.25rem; text-align: center; cursor: pointer; transition: all 0.3s ease; }
        .pack-card:hover { border-color: var(--gold); transform: scale(1.02); }
        .pack-emojis { font-size: 1.2rem; margin: 0.75rem 0; }

        .emoji-card { display: inline-flex; flex-direction: column; align-items: center; padding: 0.75rem; border-radius: 10px; min-width: 70px; margin: 0.2rem; cursor: pointer; transition: all 0.3s ease; }
        .emoji-card:hover { transform: scale(1.1); }
        .emoji-card .emoji { font-size: 2rem; }
        .emoji-card.common { background: rgba(255,255,255,0.1); border: 1px solid var(--rarity-common); }
        .emoji-card.uncommon { background: rgba(34,197,94,0.15); border: 1px solid var(--rarity-uncommon); }
        .emoji-card.rare { background: rgba(59,130,246,0.15); border: 1px solid var(--rarity-rare); }
        .emoji-card.epic { background: rgba(168,85,247,0.15); border: 1px solid var(--rarity-epic); }
        .emoji-card.legendary { background: rgba(251,191,36,0.15); border: 1px solid var(--rarity-legendary); }
        .emoji-card.mythic { background: rgba(236,72,153,0.15); border: 1px solid var(--rarity-mythic); }
        .emoji-card.divine { background: rgba(6,182,212,0.2); border: 2px solid var(--rarity-divine); }

        .rarity-badge { display: inline-block; padding: 0.15rem 0.4rem; border-radius: 6px; font-size: 0.55rem; font-weight: 700; text-transform: uppercase; }
        .rarity-badge.common { background: var(--rarity-common); color: #000; }
        .rarity-badge.uncommon { background: var(--rarity-uncommon); color: #000; }
        .rarity-badge.rare { background: var(--rarity-rare); color: #fff; }
        .rarity-badge.epic { background: var(--rarity-epic); color: #fff; }
        .rarity-badge.legendary { background: var(--rarity-legendary); color: #000; }
        .rarity-badge.mythic { background: var(--rarity-mythic); color: #fff; }
        .rarity-badge.divine { background: var(--rarity-divine); color: #000; }

        .toast { position: fixed; top: 1rem; right: -400px; padding: 0.75rem 1.25rem; background: linear-gradient(135deg, #2563eb, #fbbf24); border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); transition: right 0.4s ease; z-index: 2000; color: white; font-weight: 600; font-size: 0.85rem; }
        .toast.show { right: 1rem; }
        .toast.success { background: linear-gradient(135deg, #10b981, #059669); }
        .toast.error { background: linear-gradient(135deg, #ef4444, #dc2626); }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(5, 8, 23, 0.9); backdrop-filter: blur(10px); z-index: 1000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 20px; padding: 1.5rem; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .modal-close { background: none; border: none; color: var(--text-muted); font-size: 1.5rem; cursor: pointer; }

        .hidden { display: none !important; }
        .tab-content { animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .empty-state { text-align: center; padding: 2rem; color: var(--text-muted); }
        .empty-icon { font-size: 3rem; opacity: 0.3; margin-bottom: 0.5rem; }

        .verification-input { display: flex; gap: 0.4rem; justify-content: center; margin: 1rem 0; }
        .verification-input input { width: 45px; height: 55px; text-align: center; font-size: 1.3rem; font-weight: 700; background: rgba(15, 23, 42, 0.6); border: 2px solid var(--border); border-radius: 10px; color: var(--text-primary); }
        .verification-input input:focus { border-color: var(--gold); outline: none; }

        @media (max-width: 768px) {
            .logo-text { font-size: 1.5rem; }
            .balance-amount { font-size: 2rem; }
            .tab-container { flex-direction: column; }
        }

        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Auth Screen -->
        <div id="authScreen">
            <div style="max-width: 450px; margin: 0 auto;">
                <div class="logo-container" style="justify-content: center;">
                    <div class="logo-icon">üèõÔ∏è</div>
                    <span class="logo-text">Lintoria</span>
                    <span class="logo-badge">V4.02</span>
                </div>

                <div class="disclaimer-banner">
                    <strong>‚ö†Ô∏è DISCLAIMER:</strong> Lintoria Hub is a <strong>virtual economy simulation</strong> with NO real money. 
                    This app holds <strong>no responsibility</strong> for misuse (including playing at school/work). For entertainment only!
                </div>

                <div class="glass-card">
                    <div id="authTabs">
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem;">
                            <button class="btn active" style="flex: 1;" onclick="switchAuthTab('login')" id="loginTabBtn">Login</button>
                            <button class="btn" style="flex: 1; background: rgba(37,99,235,0.2);" onclick="switchAuthTab('register')" id="registerTabBtn">Register</button>
                        </div>

                        <div id="loginTab">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="loginEmail" class="form-input" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Password</label>
                                <input type="password" id="loginPassword" class="form-input" placeholder="Password">
                            </div>
                            <button class="btn btn-success" onclick="login()" style="width: 100%;">Sign In</button>
                        </div>

                        <div id="registerTab" class="hidden">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="registerEmail" class="form-input" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Name</label>
                                <input type="text" id="registerName" class="form-input" placeholder="Your name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Password</label>
                                <input type="password" id="registerPassword" class="form-input" placeholder="Choose password">
                            </div>
                            <button class="btn btn-success" onclick="register()" style="width: 100%;">Create Account</button>
                        </div>
                    </div>

                    <div id="verificationScreen" class="hidden">
                        <div style="text-align: center;">
                            <div style="font-size: 3rem;">üìß</div>
                            <h3 style="color: var(--gold); margin: 0.5rem 0;">Verify Email</h3>
                            <p style="color: var(--text-muted); font-size: 0.85rem;">Code sent to <strong id="verifyEmailDisplay"></strong></p>
                            
                            <div class="verification-input">
                                <input type="text" maxlength="1" id="code1" oninput="handleCodeInput(1)">
                                <input type="text" maxlength="1" id="code2" oninput="handleCodeInput(2)">
                                <input type="text" maxlength="1" id="code3" oninput="handleCodeInput(3)">
                                <input type="text" maxlength="1" id="code4" oninput="handleCodeInput(4)">
                                <input type="text" maxlength="1" id="code5" oninput="handleCodeInput(5)">
                                <input type="text" maxlength="1" id="code6" oninput="handleCodeInput(6)">
                            </div>
                            
                            <button class="btn btn-success" onclick="verifyCode()" style="width: 100%; margin-bottom: 0.5rem;">Verify</button>
                            <button class="btn btn-sm" onclick="resendCode()" style="opacity: 0.7;">Resend Code</button>
                            <br><br>
                            <button class="btn btn-sm btn-danger" onclick="backToLogin()">Back</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="appScreen" class="hidden">
            <div class="disclaimer-banner" style="padding: 0.5rem 1rem; font-size: 0.7rem;">
                ‚ö†Ô∏è Virtual simulation - NO real money - Entertainment only!
            </div>

            <!-- Header -->
            <div class="glass-card" style="padding: 1rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div class="logo-icon" style="width: 40px; height: 40px; font-size: 20px;">üèõÔ∏è</div>
                        <div>
                            <div style="font-weight: 700; color: var(--gold);">Lintoria Hub</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">
                                <span id="userName"></span>
                                <span id="masterBadge" class="hidden" style="color: var(--gold);"> ‚ö°Admin</span>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="text-align: right;">
                            <div style="font-size: 0.65rem; color: var(--text-muted);">CREDIT SCORE</div>
                            <div id="headerCreditScore" style="font-weight: 700; color: var(--gold);">600</div>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="logout()">Logout</button>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="tab-container">
                <div class="tab-section">
                    <button class="tab-btn active" onclick="switchTab('dashboard')">üè¶ Bank</button>
                    <button class="tab-btn" onclick="switchTab('transfer')">üí∏ Send</button>
                    <button class="tab-btn" onclick="switchTab('loans')">üí≥ Loans</button>
                </div>
                <div class="tab-section">
                    <button class="tab-btn" onclick="switchTab('stocks')">üìà Stocks</button>
                    <button class="tab-btn" onclick="switchTab('portfolio')">üíº Portfolio</button>
                </div>
                <div class="tab-section">
                    <button class="tab-btn" onclick="switchTab('packs')">üéÅ Packs</button>
                    <button class="tab-btn" onclick="switchTab('collection')">üéí Collection</button>
                </div>
                <div class="tab-section">
                    <button class="tab-btn" onclick="switchTab('casino')">üé∞ Casino</button>
                    <button class="tab-btn" onclick="switchTab('chat')">üí¨ Chat</button>
                    <button class="tab-btn" onclick="switchTab('leaderboard')">üèÜ Leaders</button>
                </div>
                <div class="tab-section">
                    <button class="tab-btn" onclick="switchTab('reset')">üîÑ Reset</button>
                </div>
                <div class="tab-section hidden" id="adminSection">
                    <button class="tab-btn" onclick="switchTab('admin')">üëë Admin</button>
                </div>
            </div>

            <!-- Dashboard -->
            <div id="dashboardContent" class="tab-content">
                <div class="balance-card">
                    <div class="balance-label">Total Balance</div>
                    <div class="balance-amount">$<span id="balanceAmount">0.00</span></div>
                </div>

                <div class="glass-card">
                    <div class="section-header">
                        <h2>üìä Recent Transactions</h2>
                        <span class="badge" id="transactionCount">0</span>
                    </div>
                    <div id="transactionList">
                        <div class="empty-state"><div class="empty-icon">üí∞</div><p>No transactions</p></div>
                    </div>
                </div>
            </div>

            <!-- Transfer -->
            <div id="transferContent" class="tab-content hidden">
                <div class="glass-card">
                    <h2 style="color: var(--gold); margin-bottom: 1rem;">üí∏ Send Money</h2>
                    <div class="form-group">
                        <label class="form-label">Recipient Email</label>
                        <input type="email" id="recipientEmail" class="form-input" placeholder="recipient@email.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" id="transferAmount" class="form-input" placeholder="0.00" min="0.01" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Note (Optional)</label>
                        <input type="text" id="transferNote" class="form-input" placeholder="What's this for?">
                    </div>
                    <button class="btn btn-success" onclick="transferMoney()" style="width: 100%;">Send Money</button>
                </div>
            </div>

            <!-- LOANS -->
            <div id="loansContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üí≥ Credit & Loans</h2>
                        <button class="btn btn-sm" onclick="loadLoans()">Refresh</button>
                    </div>

                    <!-- Credit Score Display -->
                    <div class="credit-score-card">
                        <div style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Credit Score</div>
                        <div class="credit-score-number" id="creditScoreDisplay">600</div>
                        <div class="credit-tier" id="creditTierDisplay">Fair</div>
                        <div style="margin-top: 0.75rem; font-size: 0.8rem;">
                            <span style="color: var(--text-muted);">Max Loan:</span> 
                            <span style="color: var(--gold); font-weight: 700;" id="maxLoanDisplay">$50,000</span>
                            <span style="color: var(--text-muted); margin-left: 1rem;">Interest:</span>
                            <span style="color: var(--danger); font-weight: 700;" id="interestRateDisplay">15%</span>
                        </div>
                    </div>

                    <div style="background: rgba(37, 99, 235, 0.1); border-radius: 10px; padding: 0.75rem; margin-bottom: 1rem; font-size: 0.8rem;">
                        <strong style="color: var(--gold);">üí° How Credit Score Works:</strong>
                        <ul style="margin: 0.5rem 0 0 1rem; color: var(--text-secondary);">
                            <li>On-time payments: +5 points</li>
                            <li>Late payments: -15 points</li>
                            <li>Pay off loan early: +20 points</li>
                            <li>Loan default: -100 points</li>
                        </ul>
                    </div>

                    <!-- Active Loans -->
                    <h3 style="color: var(--gold); margin: 1rem 0 0.75rem;">üìã Your Active Loans (<span id="activeLoansCount">0</span>/3)</h3>
                    <div id="activeLoansContainer">
                        <div class="empty-state" style="padding: 1rem;"><p>No active loans</p></div>
                    </div>

                    <!-- Apply for Loan -->
                    <h3 style="color: var(--gold); margin: 1.5rem 0 0.75rem;">‚ú® Apply for New Loan</h3>
                    <div class="service-grid" id="loanTypesContainer">
                        <div class="empty-state"><p>Loading...</p></div>
                    </div>
                </div>

                <!-- Loan History -->
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üìú Loan History</h2>
                    </div>
                    <div id="loanHistoryContainer">
                        <div class="empty-state" style="padding: 1rem;"><p>No loan history</p></div>
                    </div>
                </div>
            </div>

            <!-- Stocks -->
            <div id="stocksContent" class="tab-content hidden">
                <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 10px; padding: 0.75rem; margin-bottom: 1rem; font-size: 0.8rem;">
                    ‚ö†Ô∏è <strong>5% Tax</strong> on all stock transactions
                </div>
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üìà Stocks</h2>
                        <button class="btn btn-sm" onclick="loadStocks()">Refresh</button>
                    </div>
                    <div id="stocksList"><div class="empty-state"><p>Loading...</p></div></div>
                </div>
            </div>

            <!-- Portfolio -->
            <div id="portfolioContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header"><h2>üíº Portfolio</h2></div>
                    <div id="portfolioList"><div class="empty-state"><p>No stocks</p></div></div>
                </div>
            </div>

            <!-- Packs -->
            <div id="packsContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üéÅ Emoji Packs</h2>
                        <button class="btn btn-sm" onclick="showChancesModal()">üìä Chances</button>
                    </div>
                    <p style="color: var(--gold); font-weight: 700; margin-bottom: 1rem;">$7,500 per pack</p>
                    <div class="service-grid" id="packsList"><div class="empty-state"><p>Loading...</p></div></div>
                </div>
            </div>

            <!-- Collection -->
            <div id="collectionContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üéí Collection</h2>
                        <span class="badge" id="emojiScore">0 pts</span>
                    </div>
                    <div id="emojiCollection"><div class="empty-state"><p>No emojis</p></div></div>
                </div>
            </div>

            <!-- Casino -->
            <div id="casinoContent" class="tab-content hidden">
                <div class="glass-card">
                    <h2 style="color: var(--gold); margin-bottom: 0.5rem;">üé∞ Casino</h2>
                    <p style="color: var(--danger); font-size: 0.8rem; margin-bottom: 1rem;">‚ö†Ô∏è House edge: 40-60 odds. Virtual currency only!</p>
                    
                    <div class="service-grid">
                        <div class="casino-game">
                            <h3 style="color: var(--gold);">üé° Roulette</h3>
                            <input type="number" id="rouletteBet" class="form-input" placeholder="Bet" min="1" style="margin: 0.5rem 0;">
                            <div style="display: grid; grid-template-columns: repeat(3,1fr); gap: 0.3rem;">
                                <button class="btn btn-sm" onclick="playRoulette('red')" style="background: #dc2626;">Red</button>
                                <button class="btn btn-sm" onclick="playRoulette('black')" style="background: #1f2937;">Black</button>
                                <button class="btn btn-sm btn-success" onclick="playRoulette('green')">Green</button>
                            </div>
                            <div id="rouletteResult" style="margin-top: 0.5rem; font-weight: 700; text-align: center;"></div>
                        </div>

                        <div class="casino-game">
                            <h3 style="color: var(--gold);">üé≤ Dice</h3>
                            <input type="number" id="diceBet" class="form-input" placeholder="Bet" min="1" style="margin: 0.5rem 0;">
                            <button class="btn" onclick="playDice()" style="width: 100%;">Roll</button>
                            <div id="diceResult" style="margin-top: 0.5rem; font-weight: 700; text-align: center;"></div>
                        </div>

                        <div class="casino-game">
                            <h3 style="color: var(--gold);">üé∞ Slots</h3>
                            <input type="number" id="slotsBet" class="form-input" placeholder="Bet" min="1" style="margin: 0.5rem 0;">
                            <button class="btn btn-success" onclick="playSlots()" style="width: 100%;">Spin</button>
                            <div id="slotsResult" style="margin-top: 0.5rem; font-weight: 700; text-align: center;"></div>
                        </div>

                        <div class="casino-game">
                            <h3 style="color: var(--gold);">üìç Plinko</h3>
                            <input type="number" id="plinkoBet" class="form-input" placeholder="Bet" min="1" style="margin: 0.5rem 0;">
                            <button class="btn btn-success" onclick="playPlinko()" style="width: 100%;">Drop</button>
                            <div id="plinkoResult" style="margin-top: 0.5rem; font-weight: 700; text-align: center;"></div>
                        </div>

                        <div class="casino-game">
                            <h3 style="color: var(--gold);">üé° Wheel</h3>
                            <input type="number" id="wheelBet" class="form-input" placeholder="Bet" min="1" style="margin: 0.5rem 0;">
                            <button class="btn btn-success" onclick="playWheel()" style="width: 100%;">Spin</button>
                            <div id="wheelResult" style="margin-top: 0.5rem; font-weight: 700; text-align: center;"></div>
                        </div>

                        <div class="casino-game">
                            <h3 style="color: var(--gold);">üÉè Blackjack</h3>
                            <input type="number" id="blackjackBet" class="form-input" placeholder="Bet" min="1" style="margin: 0.5rem 0;">
                            <button class="btn" onclick="playBlackjack()" style="width: 100%;">Deal</button>
                            <div id="blackjackResult" style="margin-top: 0.5rem; font-weight: 700; text-align: center; font-size: 0.8rem;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat -->
            <div id="chatContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üí¨ Chat</h2>
                        <button class="btn btn-sm" onclick="loadChat()">Refresh</button>
                    </div>
                    <div class="chat-container" id="chatMessages"><div class="empty-state"><p>Loading...</p></div></div>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="text" id="chatInput" class="form-input" placeholder="Message..." maxlength="500" style="flex: 1;" onkeypress="if(event.key==='Enter')sendChat()">
                        <button class="btn btn-success" onclick="sendChat()">Send</button>
                    </div>
                </div>
            </div>

            <!-- Leaderboard -->
            <div id="leaderboardContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header"><h2>üí∞ Wealth</h2></div>
                    <div id="wealthLeaderboard"><div class="empty-state"><p>Loading...</p></div></div>
                </div>
                <div class="glass-card">
                    <div class="section-header"><h2>üéØ Emoji Score</h2></div>
                    <div id="emojiLeaderboard"><div class="empty-state"><p>Loading...</p></div></div>
                </div>
            </div>

            <!-- RESET -->
            <div id="resetContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üîÑ Account Reset</h2>
                    </div>

                    <div class="reset-card">
                        <div style="font-size: 3rem; margin-bottom: 0.5rem;">üîÑ</div>
                        <h3 style="color: var(--gold);">Fresh Start</h3>
                        <p style="color: var(--text-muted); font-size: 0.85rem; margin: 0.5rem 0;">
                            Reset your account and start over. The more you lost gambling, the bigger your bonus!
                        </p>
                        
                        <div style="background: rgba(0,0,0,0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0;">
                            <div style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase;">You Will Receive</div>
                            <div style="font-size: 2.5rem; font-weight: 900; color: var(--success);" id="resetAmountDisplay">$100,000</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">
                                Base: $100,000 + Bonus: <span id="resetBonusDisplay" style="color: var(--gold);">$0</span>
                            </div>
                        </div>

                        <div id="resetCooldown" class="hidden" style="color: var(--danger); font-weight: 700; margin-bottom: 1rem;">
                            ‚è∞ Cooldown: <span id="cooldownTime">0</span> hours remaining
                        </div>

                        <button class="btn btn-danger" onclick="resetAccount()" id="resetBtn" style="width: 100%;">
                            Reset My Account
                        </button>
                    </div>

                    <!-- Gambling Stats -->
                    <h3 style="color: var(--gold); margin: 1.5rem 0 1rem;">üìä Your Gambling Statistics</h3>
                    <div class="stat-grid" id="gamblingStatsGrid">
                        <div class="stat-item">
                            <div class="stat-label">Wagered</div>
                            <div class="stat-value" id="statWagered">$0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Won</div>
                            <div class="stat-value positive" id="statWon">$0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Lost</div>
                            <div class="stat-value negative" id="statLost">$0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Net Result</div>
                            <div class="stat-value" id="statNet">$0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Games</div>
                            <div class="stat-value" id="statGames">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Loss Rate</div>
                            <div class="stat-value" id="statLossRate">0%</div>
                        </div>
                    </div>

                    <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(251, 191, 36, 0.1); border-radius: 10px; font-size: 0.8rem;">
                        <strong style="color: var(--gold);">Reset Details:</strong>
                        <ul style="margin: 0.5rem 0 0 1rem; color: var(--text-secondary);">
                            <li>Balance ‚Üí Reset amount (base + bonus)</li>
                            <li>Credit Score ‚Üí Reset to 600</li>
                            <li>Stocks ‚Üí All sold (no payout)</li>
                            <li>Loans ‚Üí All cleared</li>
                            <li>Gambling stats ‚Üí Reset to zero</li>
                            <li><strong>Keeps:</strong> Emojis, Passport, Account</li>
                            <li>24-hour cooldown between resets</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Admin -->
            <div id="adminContent" class="tab-content hidden">
                <div class="glass-card">
                    <div class="section-header">
                        <h2>üëë Admin Panel</h2>
                        <span class="badge" id="userCount">0 users</span>
                    </div>
                    <div id="adminUsersList"><div class="empty-state"><p>Loading...</p></div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"><div id="toastMessage"></div></div>

    <!-- Chances Modal -->
    <div class="modal-overlay" id="chancesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="color: var(--gold);">üìä Drop Chances</h2>
                <button class="modal-close" onclick="closeChancesModal()">&times;</button>
            </div>
            <table style="width: 100%; font-size: 0.8rem;">
                <tr><th style="text-align: left; color: var(--gold); padding: 0.5rem;">Rarity</th><th>Chance</th><th>Points</th><th>Sell</th></tr>
                <tr><td><span class="rarity-badge common">Common</span></td><td>50%</td><td>10</td><td style="color: var(--danger);">$500</td></tr>
                <tr><td><span class="rarity-badge uncommon">Uncommon</span></td><td>30%</td><td>25</td><td style="color: var(--danger);">$2K</td></tr>
                <tr><td><span class="rarity-badge rare">Rare</span></td><td>12%</td><td>100</td><td style="color: var(--success);">$10K</td></tr>
                <tr><td><span class="rarity-badge epic">Epic</span></td><td>5%</td><td>500</td><td style="color: var(--success);">$25K</td></tr>
                <tr><td><span class="rarity-badge legendary">Legendary</span></td><td>2%</td><td>2.5K</td><td style="color: var(--success);">$75K</td></tr>
                <tr><td><span class="rarity-badge mythic">Mythic</span></td><td>0.8%</td><td>10K</td><td style="color: var(--success);">$200K</td></tr>
                <tr><td><span class="rarity-badge divine">Divine</span></td><td>0.2%</td><td>50K</td><td style="color: var(--success);">$500K</td></tr>
            </table>
            <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 1rem;">Pack cost: $7,500. Only Rare+ gives profit!</p>
        </div>
    </div>

    <!-- Loan Application Modal -->
    <div class="modal-overlay" id="loanModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="color: var(--gold);" id="loanModalTitle">Apply for Loan</h2>
                <button class="modal-close" onclick="closeLoanModal()">&times;</button>
            </div>
            <div id="loanModalContent"></div>
        </div>
    </div>

    <!-- Pack Opening -->
    <div id="packOpeningModal" class="hidden"></div>

    <script>
        const SHEETS_URL = 'https://script.google.com/macros/s/AKfycbzqSEpZIr8mRzhOSEL0uawFBkasjYROkmz_DCur-ULGWMgx_xmHe_bxVEF7uaJ7etP-pQ/exec';
        const MASTER_ADMIN = 'sheepishlyroyal@gmail.com';
        
        let currentUser = null;
        let stocks = [];
        let pendingVerificationEmail = null;
        let chatInterval = null;
        let selectedLoanType = null;

        // ============ AUTH ============
        function switchAuthTab(tab) {
            document.getElementById('loginTab').classList.toggle('hidden', tab !== 'login');
            document.getElementById('registerTab').classList.toggle('hidden', tab !== 'register');
            document.getElementById('loginTabBtn').classList.toggle('active', tab === 'login');
            document.getElementById('registerTabBtn').classList.toggle('active', tab === 'register');
            document.getElementById('loginTabBtn').style.background = tab === 'login' ? '' : 'rgba(37,99,235,0.2)';
            document.getElementById('registerTabBtn').style.background = tab === 'register' ? '' : 'rgba(37,99,235,0.2)';
        }

        async function register() {
            const email = document.getElementById('registerEmail').value.trim();
            const name = document.getElementById('registerName').value.trim();
            const password = document.getElementById('registerPassword').value.trim();
            if (!email || !name || !password) return showToast('Fill all fields', 'error');

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'register', email, name, password }) });
                const result = await res.json();
                if (result.success) {
                    pendingVerificationEmail = email;
                    showVerificationScreen(email);
                    showToast('Check email for code!', 'success');
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        function showVerificationScreen(email) {
            document.getElementById('authTabs').classList.add('hidden');
            document.getElementById('verificationScreen').classList.remove('hidden');
            document.getElementById('verifyEmailDisplay').textContent = email;
            document.getElementById('code1').focus();
        }

        function handleCodeInput(num) {
            const input = document.getElementById('code' + num);
            if (input.value.length === 1 && num < 6) document.getElementById('code' + (num + 1)).focus();
        }

        async function verifyCode() {
            const code = [1,2,3,4,5,6].map(i => document.getElementById('code' + i).value).join('');
            if (code.length !== 6) return showToast('Enter complete code', 'error');

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'verifyEmail', email: pendingVerificationEmail, code }) });
                const result = await res.json();
                if (result.success) { showToast('Verified! Login now.', 'success'); backToLogin(); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        async function resendCode() {
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'resendCode', email: pendingVerificationEmail }) });
                const result = await res.json();
                showToast(result.success ? 'Code resent!' : result.error, result.success ? 'success' : 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        function backToLogin() {
            document.getElementById('authTabs').classList.remove('hidden');
            document.getElementById('verificationScreen').classList.add('hidden');
            [1,2,3,4,5,6].forEach(i => document.getElementById('code' + i).value = '');
            switchAuthTab('login');
        }

        async function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            if (!email || !password) return showToast('Enter credentials', 'error');

            try {
                const res = await fetch(`${SHEETS_URL}?action=login&email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`);
                const result = await res.json();
                if (result.success) { currentUser = result.user; showApp(); showToast('Welcome! üéâ', 'success'); }
                else if (result.requiresVerification) { pendingVerificationEmail = result.email; showVerificationScreen(result.email); showToast('Verify email first', 'error'); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        function showApp() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('appScreen').classList.remove('hidden');
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('headerCreditScore').textContent = currentUser.creditScore || 600;
            if (currentUser.email === MASTER_ADMIN) {
                document.getElementById('masterBadge').classList.remove('hidden');
                document.getElementById('adminSection').classList.remove('hidden');
            }
            loadDashboard();
        }

        function logout() {
            currentUser = null;
            if (chatInterval) clearInterval(chatInterval);
            document.getElementById('authScreen').classList.remove('hidden');
            document.getElementById('appScreen').classList.add('hidden');
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tab + 'Content')?.classList.remove('hidden');
            event?.target?.classList.add('active');

            if (tab === 'dashboard') loadDashboard();
            else if (tab === 'stocks') loadStocks();
            else if (tab === 'portfolio') loadPortfolio();
            else if (tab === 'packs') loadPacks();
            else if (tab === 'collection') loadCollection();
            else if (tab === 'loans') loadLoans();
            else if (tab === 'reset') loadResetInfo();
            else if (tab === 'chat') { loadChat(); chatInterval = setInterval(loadChat, 5000); }
            else if (tab === 'leaderboard') loadLeaderboards();
            else if (tab === 'admin') loadAdminPanel();

            if (tab !== 'chat' && chatInterval) { clearInterval(chatInterval); chatInterval = null; }
        }

        // ============ DASHBOARD ============
        async function loadDashboard() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getUser&email=${encodeURIComponent(currentUser.email)}`);
                const result = await res.json();
                if (result.success) {
                    currentUser = result.user;
                    document.getElementById('balanceAmount').textContent = (currentUser.balance || 0).toLocaleString('en-US', { minimumFractionDigits: 2 });
                    document.getElementById('headerCreditScore').textContent = currentUser.creditScore || 600;
                }

                const txRes = await fetch(`${SHEETS_URL}?action=getTransactions&email=${encodeURIComponent(currentUser.email)}`);
                const txResult = await txRes.json();
                const list = document.getElementById('transactionList');
                if (txResult.transactions?.length > 0) {
                    document.getElementById('transactionCount').textContent = txResult.transactions.length;
                    list.innerHTML = txResult.transactions.slice(-10).reverse().map(tx => {
                        const isReceived = tx.to === currentUser.email;
                        return `<div class="transaction-item">
                            <div><div style="font-weight: 700;">${tx.type}</div><div style="color: var(--text-muted); font-size: 0.75rem;">${tx.note || ''}</div></div>
                            <div style="font-weight: 700; color: ${isReceived ? 'var(--success)' : 'var(--danger)'};">${isReceived ? '+' : '-'}$${Number(tx.amount).toFixed(2)}</div>
                        </div>`;
                    }).join('');
                } else list.innerHTML = '<div class="empty-state"><p>No transactions</p></div>';
            } catch (e) { console.error(e); }
        }

        async function transferMoney() {
            const recipient = document.getElementById('recipientEmail').value.trim();
            const amount = parseFloat(document.getElementById('transferAmount').value);
            const note = document.getElementById('transferNote').value.trim();
            if (!recipient || !amount || amount <= 0) return showToast('Invalid input', 'error');

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'transfer', from: currentUser.email, to: recipient, amount, note }) });
                const result = await res.json();
                if (result.success) {
                    showToast(`Sent $${amount.toFixed(2)}!`, 'success');
                    document.getElementById('recipientEmail').value = '';
                    document.getElementById('transferAmount').value = '';
                    document.getElementById('transferNote').value = '';
                    loadDashboard();
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        // ============ LOANS ============
        async function loadLoans() {
            try {
                const [loanInfoRes, loansRes] = await Promise.all([
                    fetch(`${SHEETS_URL}?action=getLoanInfo&email=${encodeURIComponent(currentUser.email)}`),
                    fetch(`${SHEETS_URL}?action=getLoans&email=${encodeURIComponent(currentUser.email)}`)
                ]);
                const loanInfo = await loanInfoRes.json();
                const loansData = await loansRes.json();

                // Credit Score
                document.getElementById('creditScoreDisplay').textContent = loanInfo.creditScore;
                document.getElementById('creditTierDisplay').textContent = loanInfo.creditTier;
                document.getElementById('creditTierDisplay').className = 'credit-tier ' + loanInfo.creditTier.toLowerCase().replace(' ', '-');
                document.getElementById('maxLoanDisplay').textContent = '$' + loanInfo.maxLoanAmount.toLocaleString();
                document.getElementById('interestRateDisplay').textContent = (loanInfo.interestRate * 100).toFixed(1) + '%';

                // Active Loans
                document.getElementById('activeLoansCount').textContent = loanInfo.activeLoansCount;
                const activeLoans = loansData.loans?.filter(l => l.status === 'active') || [];
                const activeContainer = document.getElementById('activeLoansContainer');
                
                if (activeLoans.length > 0) {
                    activeContainer.innerHTML = activeLoans.map(loan => {
                        const progress = (loan.amountPaid / loan.totalOwed) * 100;
                        return `<div class="loan-card active">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <div><strong style="color: var(--gold);">${loan.type}</strong></div>
                                <div style="color: var(--text-muted); font-size: 0.75rem;">ID: ${loan.id.slice(-8)}</div>
                            </div>
                            <div style="font-size: 0.85rem; margin-bottom: 0.5rem;">
                                <span style="color: var(--text-muted);">Remaining:</span> 
                                <span style="color: var(--danger); font-weight: 700;">$${loan.remaining.toFixed(2)}</span>
                                <span style="color: var(--text-muted); margin-left: 0.5rem;">of $${loan.totalOwed.toFixed(2)}</span>
                            </div>
                            <div class="progress-bar"><div class="progress-fill" style="width: ${progress}%"></div></div>
                            <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem;">
                                <span>Daily: $${loan.dailyPayment}</span>
                                <span>Late: ${loan.latePayments}</span>
                                <span>Due: ${new Date(loan.dueDate).toLocaleDateString()}</span>
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem;">
                                <button class="btn btn-sm btn-success" onclick="makePayment('${loan.id}', ${loan.dailyPayment})">Pay $${loan.dailyPayment}</button>
                                <button class="btn btn-sm" onclick="payOffLoan('${loan.id}')">Pay Off ($${loan.remaining.toFixed(2)})</button>
                            </div>
                        </div>`;
                    }).join('');
                } else {
                    activeContainer.innerHTML = '<div style="text-align: center; padding: 1rem; color: var(--text-muted);">No active loans</div>';
                }

                // Loan Types
                const typesContainer = document.getElementById('loanTypesContainer');
                typesContainer.innerHTML = loanInfo.loanTypes.map(type => `
                    <div class="loan-type-card ${!type.available ? 'disabled' : ''}" onclick="${type.available ? `openLoanModal('${type.id}')` : ''}">
                        <h3 style="color: var(--gold); font-size: 1rem;">${type.name}</h3>
                        <p style="font-size: 0.75rem; color: var(--text-muted); margin: 0.5rem 0;">${type.description}</p>
                        <div style="font-size: 0.8rem;">
                            <div>Max: <strong style="color: var(--success);">$${type.maxAmount.toLocaleString()}</strong></div>
                            <div>Term: <strong>${type.termDays} days</strong></div>
                            <div>Interest: <strong style="color: var(--danger);">${(type.interestRate * 100).toFixed(1)}%</strong></div>
                        </div>
                        ${!type.available ? '<div style="color: var(--danger); font-size: 0.75rem; margin-top: 0.5rem;">Max loans reached or insufficient credit</div>' : ''}
                    </div>
                `).join('');

                // Loan History
                const historyLoans = loansData.loans?.filter(l => l.status !== 'active') || [];
                const historyContainer = document.getElementById('loanHistoryContainer');
                if (historyLoans.length > 0) {
                    historyContainer.innerHTML = historyLoans.slice(-5).reverse().map(loan => `
                        <div class="loan-card ${loan.status}">
                            <div style="display: flex; justify-content: space-between;">
                                <div><strong>${loan.type}</strong> - $${loan.principal.toLocaleString()}</div>
                                <span class="badge" style="background: ${loan.status === 'paid' ? 'var(--success)' : loan.status === 'defaulted' ? 'var(--danger)' : 'var(--text-muted)'}; color: white;">${loan.status.toUpperCase()}</span>
                            </div>
                        </div>
                    `).join('');
                } else {
                    historyContainer.innerHTML = '<div style="text-align: center; padding: 1rem; color: var(--text-muted);">No loan history</div>';
                }
            } catch (e) { console.error(e); }
        }

        function openLoanModal(typeId) {
            selectedLoanType = typeId;
            document.getElementById('loanModalTitle').textContent = 'Apply for Loan';
            document.getElementById('loanModalContent').innerHTML = `
                <div class="form-group">
                    <label class="form-label">Loan Amount ($)</label>
                    <input type="number" id="loanAmountInput" class="form-input" placeholder="Enter amount" min="100">
                </div>
                <div id="loanPreview" style="background: rgba(37,99,235,0.1); border-radius: 10px; padding: 1rem; margin-bottom: 1rem;">
                    <div style="font-size: 0.8rem; color: var(--text-muted);">Enter an amount to see preview</div>
                </div>
                <button class="btn btn-success" onclick="submitLoanApplication()" style="width: 100%;">Apply for Loan</button>
            `;
            document.getElementById('loanAmountInput').addEventListener('input', updateLoanPreview);
            document.getElementById('loanModal').classList.add('active');
        }

        async function updateLoanPreview() {
            const amount = parseFloat(document.getElementById('loanAmountInput').value);
            if (!amount || amount <= 0) return;

            try {
                const res = await fetch(`${SHEETS_URL}?action=getLoanInfo&email=${encodeURIComponent(currentUser.email)}`);
                const info = await res.json();
                const type = info.loanTypes.find(t => t.id === selectedLoanType);
                if (!type) return;

                const interest = amount * info.interestRate;
                const total = amount + interest;
                const daily = (total / type.termDays).toFixed(2);

                document.getElementById('loanPreview').innerHTML = `
                    <div style="font-size: 0.85rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem;">
                            <span style="color: var(--text-muted);">Principal:</span>
                            <span style="color: var(--text-primary);">$${amount.toLocaleString()}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem;">
                            <span style="color: var(--text-muted);">Interest (${(info.interestRate * 100).toFixed(1)}%):</span>
                            <span style="color: var(--danger);">+$${interest.toFixed(2)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; border-top: 1px solid var(--border); padding-top: 0.3rem;">
                            <span style="color: var(--gold); font-weight: 700;">Total to Repay:</span>
                            <span style="color: var(--gold); font-weight: 700;">$${total.toFixed(2)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: var(--text-muted);">Daily Payment:</span>
                            <span style="color: var(--text-primary);">$${daily}</span>
                        </div>
                    </div>
                `;
            } catch (e) { console.error(e); }
        }

        async function submitLoanApplication() {
            const amount = parseFloat(document.getElementById('loanAmountInput').value);
            if (!amount || amount <= 0) return showToast('Enter valid amount', 'error');

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'applyLoan', email: currentUser.email, loanType: selectedLoanType, amount }) });
                const result = await res.json();
                if (result.success) {
                    showToast(`Loan approved! $${amount.toLocaleString()} deposited.`, 'success');
                    closeLoanModal();
                    loadLoans();
                    loadDashboard();
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        function closeLoanModal() {
            document.getElementById('loanModal').classList.remove('active');
            selectedLoanType = null;
        }

        async function makePayment(loanId, amount) {
            if (currentUser.balance < amount) return showToast('Insufficient funds', 'error');

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'payLoan', email: currentUser.email, loanId, amount }) });
                const result = await res.json();
                if (result.success) {
                    showToast(`Payment made! ${result.payment.isOnTime ? '+5 credit' : '-15 credit (late)'}`, result.payment.isOnTime ? 'success' : 'error');
                    loadLoans();
                    loadDashboard();
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        async function payOffLoan(loanId) {
            if (!confirm('Pay off entire loan?')) return;

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'payOffLoan', email: currentUser.email, loanId }) });
                const result = await res.json();
                if (result.success) {
                    showToast('Loan paid off! üéâ', 'success');
                    loadLoans();
                    loadDashboard();
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        // ============ RESET ============
        async function loadResetInfo() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getResetInfo&email=${encodeURIComponent(currentUser.email)}`);
                const info = await res.json();

                document.getElementById('resetAmountDisplay').textContent = '$' + info.resetAmount.total.toLocaleString();
                document.getElementById('resetBonusDisplay').textContent = '$' + info.resetAmount.bonus.toLocaleString();
                
                document.getElementById('resetCooldown').classList.toggle('hidden', info.canReset);
                document.getElementById('cooldownTime').textContent = info.cooldownHours;
                document.getElementById('resetBtn').disabled = !info.canReset;

                const stats = info.gamblingStats;
                document.getElementById('statWagered').textContent = '$' + stats.totalWagered.toLocaleString();
                document.getElementById('statWon').textContent = '$' + stats.totalWon.toLocaleString();
                document.getElementById('statLost').textContent = '$' + stats.totalLost.toLocaleString();
                document.getElementById('statNet').textContent = (stats.netResult >= 0 ? '+$' : '-$') + Math.abs(stats.netResult).toLocaleString();
                document.getElementById('statNet').className = 'stat-value ' + (stats.netResult >= 0 ? 'positive' : 'negative');
                document.getElementById('statGames').textContent = stats.gamesPlayed;
                document.getElementById('statLossRate').textContent = stats.lossPercentage + '%';
            } catch (e) { console.error(e); }
        }

        async function resetAccount() {
            if (!confirm('Are you sure? This will reset your balance, stocks, loans, and gambling stats. Emojis and passport are kept.')) return;

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'resetAccount', email: currentUser.email }) });
                const result = await res.json();
                if (result.success) {
                    showToast(`Account reset! New balance: $${result.newBalance.toLocaleString()}`, 'success');
                    loadResetInfo();
                    loadDashboard();
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        // ============ STOCKS ============
        async function loadStocks() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getStocks`);
                const result = await res.json();
                stocks = result.stocks || [];
                document.getElementById('stocksList').innerHTML = stocks.length > 0 
                    ? stocks.map(s => `<div class="service-card" style="cursor: pointer;" onclick="tradeStock('${s.symbol}')">
                        <div style="display: flex; justify-content: space-between;">
                            <div><strong style="color: var(--gold);">${s.symbol}</strong><div style="font-size: 0.75rem; color: var(--text-muted);">${s.name}</div></div>
                            <div style="text-align: right;"><div style="font-weight: 700; color: var(--gold);">$${s.price.toFixed(2)}</div><div style="font-size: 0.7rem; color: var(--text-muted);">${s.shares.toLocaleString()} avail</div></div>
                        </div>
                    </div>`).join('')
                    : '<div class="empty-state"><p>No stocks</p></div>';
            } catch (e) { console.error(e); }
        }

        function tradeStock(symbol) {
            const shares = prompt(`${symbol}: Enter shares to BUY (negative to SELL):`);
            if (!shares) return;
            const num = parseInt(shares);
            if (isNaN(num) || num === 0) return;
            if (num > 0) buyStock(symbol, num);
            else sellStock(symbol, Math.abs(num));
        }

        async function buyStock(symbol, shares) {
            const stock = stocks.find(s => s.symbol === symbol);
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'buyStock', email: currentUser.email, symbol, shares, price: stock.price }) });
                const result = await res.json();
                if (result.success) { showToast(`Bought ${shares} ${symbol}!`, 'success'); loadDashboard(); loadStocks(); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        async function sellStock(symbol, shares) {
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'sellStock', email: currentUser.email, symbol, shares }) });
                const result = await res.json();
                if (result.success) { showToast(`Sold for $${result.amount.toFixed(2)}!`, 'success'); loadDashboard(); loadStocks(); loadPortfolio(); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        async function loadPortfolio() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getPortfolio&email=${encodeURIComponent(currentUser.email)}`);
                const result = await res.json();
                document.getElementById('portfolioList').innerHTML = result.portfolio?.length > 0
                    ? result.portfolio.map(p => `<div class="service-card" onclick="tradeStock('${p.symbol}')" style="cursor: pointer;">
                        <div style="display: flex; justify-content: space-between;">
                            <div><strong style="color: var(--gold);">${p.symbol}</strong><div style="font-size: 0.75rem; color: var(--text-muted);">${p.shares} shares @ $${p.avgPrice.toFixed(2)}</div></div>
                            <div style="text-align: right;"><div style="font-weight: 700;">$${(p.shares * p.currentPrice).toFixed(2)}</div><div style="color: ${p.profit >= 0 ? 'var(--success)' : 'var(--danger)'};">${p.profit >= 0 ? '+' : ''}$${p.profit.toFixed(2)}</div></div>
                        </div>
                    </div>`).join('')
                    : '<div class="empty-state"><p>No stocks owned</p></div>';
            } catch (e) { console.error(e); }
        }

        // ============ PACKS & EMOJIS ============
        function showChancesModal() { document.getElementById('chancesModal').classList.add('active'); }
        function closeChancesModal() { document.getElementById('chancesModal').classList.remove('active'); }

        async function loadPacks() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getPackInfo`);
                const info = await res.json();
                document.getElementById('packsList').innerHTML = info.packs?.map(p => `
                    <div class="pack-card" onclick="buyPack('${p.id}')">
                        <h3 style="color: var(--gold);">${p.name}</h3>
                        <div class="pack-emojis">${p.emojis.map(e => e.emoji).join('')}</div>
                        <p style="color: var(--gold); font-weight: 700;">$7,500</p>
                    </div>
                `).join('') || '<div class="empty-state"><p>No packs</p></div>';
            } catch (e) { console.error(e); }
        }

        async function buyPack(packId) {
            if (currentUser.balance < 7500) return showToast('Need $7,500!', 'error');
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'buyPack', email: currentUser.email, packId }) });
                const result = await res.json();
                if (result.success) {
                    const colors = { common: '#fff', uncommon: '#22c55e', rare: '#3b82f6', epic: '#a855f7', legendary: '#fbbf24', mythic: '#ec4899', divine: '#06b6d4' };
                    const modal = document.getElementById('packOpeningModal');
                    modal.className = '';
                    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(5,8,23,0.95);z-index:3000;display:flex;flex-direction:column;align-items:center;justify-content:center;';
                    modal.innerHTML = `<div style="font-size:6rem;animation:pop 0.5s ease;">${result.emoji}</div><div style="font-size:1.5rem;font-weight:800;color:${colors[result.rarity]};margin-top:0.5rem;">${result.rarity.toUpperCase()}!</div><p style="color:var(--text-muted);">${result.isDuplicate ? 'Duplicate' : '+' + result.points + ' pts'}</p><button class="btn" onclick="document.getElementById('packOpeningModal').className='hidden'" style="margin-top:1rem;">Continue</button>`;
                    loadDashboard();
                } else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        async function loadCollection() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getEmojis&email=${encodeURIComponent(currentUser.email)}`);
                const result = await res.json();
                document.getElementById('emojiScore').textContent = result.totalPoints + ' pts';
                document.getElementById('emojiCollection').innerHTML = result.emojis?.length > 0
                    ? `<div style="display:flex;flex-wrap:wrap;gap:0.3rem;">${result.emojis.map(e => `<div class="emoji-card ${e.rarity}" onclick="sellEmoji('${e.emoji}','${e.rarity}',${result.sellPrices[e.rarity]})"><div class="emoji">${e.emoji}</div><span class="rarity-badge ${e.rarity}">${e.rarity}</span>${e.count > 1 ? `<span style="font-size:0.6rem;">x${e.count}</span>` : ''}</div>`).join('')}</div>`
                    : '<div class="empty-state"><p>No emojis</p></div>';
            } catch (e) { console.error(e); }
        }

        async function sellEmoji(emoji, rarity, price) {
            if (!confirm(`Sell ${emoji} for $${price.toLocaleString()}?`)) return;
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'sellEmoji', email: currentUser.email, emoji }) });
                const result = await res.json();
                if (result.success) { showToast(`Sold for $${result.sellPrice.toLocaleString()}!`, 'success'); loadDashboard(); loadCollection(); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        // ============ CASINO ============
        async function playGame(game, bet, extra = {}) {
            const betInput = document.getElementById(game + 'Bet');
            const betAmount = parseFloat(betInput?.value || bet);
            if (!betAmount || betAmount <= 0 || betAmount > currentUser.balance) return showToast('Invalid bet', 'error');

            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'play' + game.charAt(0).toUpperCase() + game.slice(1), email: currentUser.email, bet: betAmount, ...extra }) });
                return await res.json();
            } catch (e) { showToast('Network error', 'error'); return null; }
        }

        async function playRoulette(color) {
            const result = await playGame('roulette', null, { color });
            if (result?.success) {
                const emoji = result.color === 'red' ? 'üî¥' : result.color === 'black' ? '‚ö´' : 'üü¢';
                document.getElementById('rouletteResult').innerHTML = `<span style="color:${result.won ? 'var(--success)' : 'var(--danger)'}">${emoji} ${result.result} - ${result.won ? 'Won $' + result.winAmount.toFixed(2) : 'Lost'}</span>`;
                document.getElementById('rouletteBet').value = '';
                loadDashboard();
            }
        }

        async function playDice() {
            const result = await playGame('dice');
            if (result?.success) {
                const emojis = ['‚öÄ','‚öÅ','‚öÇ','‚öÉ','‚öÑ','‚öÖ'];
                document.getElementById('diceResult').innerHTML = `<span style="color:${result.won ? 'var(--success)' : 'var(--danger)'}">${emojis[result.roll-1]} ${result.won ? 'Won $' + result.winAmount.toFixed(2) : 'Lost'}</span>`;
                document.getElementById('diceBet').value = '';
                loadDashboard();
            }
        }

        async function playSlots() {
            const result = await playGame('slots');
            if (result?.success) {
                document.getElementById('slotsResult').innerHTML = `<div>${result.symbols.join(' ')}</div><span style="color:${result.won ? 'var(--success)' : 'var(--danger)'}">${result.won ? result.multiplier + 'x - Won $' + result.winAmount.toFixed(2) : 'Lost'}</span>`;
                document.getElementById('slotsBet').value = '';
                loadDashboard();
            }
        }

        async function playPlinko() {
            const result = await playGame('plinko');
            if (result?.success) {
                document.getElementById('plinkoResult').innerHTML = `<span style="color:${result.profit >= 0 ? 'var(--success)' : 'var(--danger)'}">${result.multiplier}x - ${result.profit >= 0 ? '+' : ''}$${result.profit.toFixed(2)}</span>`;
                document.getElementById('plinkoBet').value = '';
                loadDashboard();
            }
        }

        async function playWheel() {
            const result = await playGame('wheel');
            if (result?.success) {
                document.getElementById('wheelResult').innerHTML = `<span style="color:${result.profit >= 0 ? 'var(--success)' : 'var(--danger)'}">${result.segment} - ${result.profit >= 0 ? '+' : ''}$${result.profit.toFixed(2)}</span>`;
                document.getElementById('wheelBet').value = '';
                loadDashboard();
            }
        }

        async function playBlackjack() {
            const result = await playGame('blackjack');
            if (result?.success) {
                document.getElementById('blackjackResult').innerHTML = `<div>You: ${result.playerTotal} | Dealer: ${result.dealerTotal}</div><span style="color:${result.won ? 'var(--success)' : 'var(--danger)'}">${result.result}${result.won ? ' - Won $' + result.winAmount.toFixed(2) : ''}</span>`;
                document.getElementById('blackjackBet').value = '';
                loadDashboard();
            }
        }

        // ============ CHAT ============
        async function loadChat() {
            try {
                const res = await fetch(`${SHEETS_URL}?action=getChat&limit=30`);
                const result = await res.json();
                const container = document.getElementById('chatMessages');
                container.innerHTML = result.messages?.length > 0
                    ? result.messages.map(m => `<div class="chat-message"><div class="chat-username">${m.username}</div><div class="chat-text">${m.message}</div><div class="chat-time">${new Date(m.timestamp).toLocaleString()}</div></div>`).join('')
                    : '<div class="empty-state"><p>No messages</p></div>';
                container.scrollTop = container.scrollHeight;
            } catch (e) { console.error(e); }
        }

        async function sendChat() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'sendChat', email: currentUser.email, username: currentUser.name, message }) });
                const result = await res.json();
                if (result.success) { input.value = ''; loadChat(); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        // ============ LEADERBOARDS ============
        async function loadLeaderboards() {
            try {
                const [wealth, emoji] = await Promise.all([
                    fetch(`${SHEETS_URL}?action=getLeaderboard`).then(r => r.json()),
                    fetch(`${SHEETS_URL}?action=getEmojiLeaderboard`).then(r => r.json())
                ]);
                const medals = ['üëë', 'ü•à', 'ü•â'];
                document.getElementById('wealthLeaderboard').innerHTML = wealth.users?.slice(0, 10).map((u, i) => `<div class="transaction-item"><span>${i < 3 ? medals[i] : '#' + (i+1)} ${u.name}</span><span style="color:var(--gold);font-weight:700;">$${Number(u.balance).toLocaleString()}</span></div>`).join('') || '<p>No data</p>';
                document.getElementById('emojiLeaderboard').innerHTML = emoji.leaderboard?.slice(0, 10).map((u, i) => `<div class="transaction-item"><span>${i < 3 ? medals[i] : '#' + (i+1)} ${u.name}</span><span style="color:var(--gold);font-weight:700;">${u.score.toLocaleString()} pts</span></div>`).join('') || '<p>No data</p>';
            } catch (e) { console.error(e); }
        }

        // ============ ADMIN ============
        async function loadAdminPanel() {
            if (currentUser.email !== MASTER_ADMIN) return;
            try {
                const res = await fetch(`${SHEETS_URL}?action=getAllUsers`);
                const result = await res.json();
                document.getElementById('userCount').textContent = result.users?.length + ' users';
                document.getElementById('adminUsersList').innerHTML = result.users?.map((u, i) => `<div class="service-card"><div style="display:flex;justify-content:space-between;"><div><strong>${u.name}</strong><div style="font-size:0.75rem;color:var(--text-muted);">${u.email}</div></div><div style="text-align:right;"><div style="color:var(--gold);font-weight:700;">$${Number(u.balance).toFixed(2)}</div><div style="font-size:0.75rem;">Credit: ${u.creditScore}</div></div></div><div style="display:flex;gap:0.5rem;margin-top:0.75rem;"><input type="number" id="amt${i}" class="form-input" placeholder="+/- amount" style="flex:1;"><button class="btn btn-sm btn-success" onclick="adminUpdate('${u.email}',${i})">Update</button></div></div>`).join('') || '<p>No users</p>';
            } catch (e) { console.error(e); }
        }

        async function adminUpdate(email, idx) {
            const amount = parseFloat(document.getElementById('amt' + idx).value);
            if (isNaN(amount)) return showToast('Enter amount', 'error');
            try {
                const res = await fetch(SHEETS_URL, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'adminUpdateBalance', adminEmail: currentUser.email, targetEmail: email, amount }) });
                const result = await res.json();
                if (result.success) { showToast('Updated!', 'success'); loadAdminPanel(); }
                else showToast(result.error, 'error');
            } catch (e) { showToast('Network error', 'error'); }
        }

        // ============ UTILS ============
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        document.getElementById('chancesModal')?.addEventListener('click', e => { if (e.target.classList.contains('modal-overlay')) closeChancesModal(); });
        document.getElementById('loanModal')?.addEventListener('click', e => { if (e.target.classList.contains('modal-overlay')) closeLoanModal(); });
    </script>
</body>
</html>
